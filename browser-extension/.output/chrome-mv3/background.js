var background=(function(){"use strict";function i(e){return e==null||typeof e=="function"?{main:e}:e}const t=i(()=>{console.log("AiDeer Importer background script loaded"),typeof chrome<"u"&&chrome.runtime&&(chrome.contextMenus&&(chrome.contextMenus.removeAll(()=>{chrome.contextMenus.create({id:"aideer-collect-media",title:"收集页面媒体文件",contexts:["page"]}),chrome.contextMenus.create({id:"aideer-save-single-media",title:"保存到 AiDeer",contexts:["image","video"]})}),chrome.contextMenus.onClicked.addListener((e,r)=>{r?.id&&(e.menuItemId==="aideer-collect-media"?chrome.tabs.sendMessage(r.id,{action:"show-media-collector"}):e.menuItemId==="aideer-save-single-media"&&chrome.tabs.sendMessage(r.id,{action:"save-single-media",mediaUrl:e.srcUrl,pageUrl:e.pageUrl}))})),chrome.action&&chrome.action.onClicked.addListener(e=>{e.id&&chrome.tabs.sendMessage(e.id,{action:"show-media-collector"})}))});function s(){}globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome;function o(e,...r){}const c={debug:(...e)=>o(console.debug,...e),log:(...e)=>o(console.log,...e),warn:(...e)=>o(console.warn,...e),error:(...e)=>o(console.error,...e)};let n;try{n=t.main(),n instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(e){throw c.error("The background crashed on startup!"),e}return n})();
