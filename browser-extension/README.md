# 媒体文件收集器 - 浏览器插件

一个用于批量收集网页图片和视频的Chrome浏览器插件，可以将收集的媒体文件导入到后端系统中。

## 功能特性

- 🖼️ **智能媒体扫描**: 自动扫描页面中的图片和视频文件
- 📋 **批量选择**: 支持全选和单独选择媒体文件
- 🎯 **尺寸过滤**: 自动过滤小尺寸图片，避免收集无用的图标
- 🚀 **一键导入**: 将选中的媒体文件批量导入到后端系统
- ⌨️ **快捷键支持**: 使用 `Ctrl+Shift+M` 快速打开收集器
- 🎨 **现代UI**: 美观的弹窗界面，支持预览和详细信息

## 安装方法

### 方法一：开发者模式安装（推荐）

1. 打开Chrome浏览器，进入扩展程序管理页面：
   - 地址栏输入 `chrome://extensions/`
   - 或者点击右上角三点菜单 → 更多工具 → 扩展程序

2. 开启"开发者模式"（页面右上角的开关）

3. 点击"加载已解压的扩展程序"

4. 选择插件的构建输出目录：
   ```
   /Users/easy/Code/gitcode/aideer/browser-extension/.output/chrome-mv3
   ```

### 方法二：安装包安装

1. 使用构建好的zip安装包：
   ```
   /Users/easy/Code/gitcode/aideer/browser-extension/.output/browser-extension-1.0.0-chrome.zip
   ```

2. 解压zip文件，然后按照方法一的步骤3-4进行安装

## 使用方法

### 启动收集器

有三种方式可以启动媒体收集器：

1. **右键菜单**: 在任意网页上右键，选择"收集页面媒体文件"
2. **插件图标**: 点击浏览器工具栏中的插件图标
3. **快捷键**: 按下 `Ctrl+Shift+M`

### 收集媒体文件

1. 启动收集器后，插件会自动扫描当前页面的所有媒体文件
2. 在弹出的界面中，你可以：
   - 预览所有找到的图片和视频
   - 查看文件的详细信息（尺寸、文件名等）
   - 选择要导入的文件（支持单选和全选）
   - 点击"导入选中"将文件发送到后端系统

### 界面说明

- **媒体网格**: 以卡片形式展示所有找到的媒体文件
- **复选框**: 点击右上角的复选框选择文件
- **预览区**: 显示图片缩略图或视频第一帧
- **文件信息**: 显示文件类型、名称和尺寸
- **控制按钮**:
  - "全选": 选择/取消选择所有文件
  - "导入选中": 将选中的文件发送到后端
  - "关闭": 关闭收集器界面

## 技术要求

### 浏览器支持
- Chrome 88+ (Manifest V3)
- 其他基于Chromium的浏览器（Edge、Brave等）

### 后端集成
插件需要配合后端API使用，确保以下端点可用：

```
POST http://localhost:3000/api/files/import-media
```

请求格式：
```json
{
  "mediaItems": [
    {
      "type": "image",
      "src": "https://example.com/image.jpg",
      "alt": "图片描述",
      "title": "图片标题",
      "width": 800,
      "height": 600
    }
  ],
  "source": "https://example.com/page"
}
```

## 开发说明

### 项目结构
```
browser-extension/
├── entrypoints/
│   ├── background/          # 后台脚本
│   └── content/            # 内容脚本
├── utils/
│   └── mediaScanner.ts     # 媒体扫描工具
├── wxt.config.ts           # WXT配置文件
└── package.json
```

### 构建命令
```bash
# 开发模式
npm run dev

# 生产构建
npm run build

# 创建安装包
npm run zip
```

### 核心组件

1. **MediaScanner**: 负责扫描页面媒体文件
2. **MediaCollectorOverlay**: 主要的UI界面组件
3. **Background Script**: 处理右键菜单和插件图标点击
4. **Content Script**: 在网页中注入收集器功能

## 故障排除

### 常见问题

1. **插件无法加载**
   - 检查是否开启了开发者模式
   - 确认选择了正确的构建输出目录

2. **无法扫描到媒体文件**
   - 检查页面是否包含图片或视频元素
   - 确认媒体文件尺寸是否符合过滤条件（默认最小100px）

3. **导入失败**
   - 检查后端服务是否正在运行
   - 确认API端点地址是否正确
   - 查看浏览器控制台的错误信息

4. **快捷键不工作**
   - 确认当前页面允许脚本执行
   - 检查是否与其他扩展的快捷键冲突

### 调试方法

1. 打开Chrome开发者工具（F12）
2. 查看Console标签页的日志信息
3. 在Extensions页面点击插件的"详细信息"查看错误

## 更新日志

### v1.0.0
- 初始版本发布
- 支持图片和视频文件扫描
- 实现批量选择和导入功能
- 添加快捷键支持
- 集成后端API

## 许可证

MIT License